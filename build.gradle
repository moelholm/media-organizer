buildscript {
    ext {
        springBootVersion = '1.5.1.RELEASE'
        commonsLangVersion = '2.4'
    }
    repositories {
        mavenCentral()
    }
    dependencies {
        classpath "org.springframework.boot:spring-boot-gradle-plugin:${springBootVersion}"
    }
}

plugins {
    id 'com.github.sherter.google-java-format' version '0.7.1'
}

apply plugin: 'java'
apply plugin: 'org.springframework.boot'

group 'com.moelholm'

sourceCompatibility = 1.8

repositories {
    mavenCentral()
}

dependencies {

    compile "org.springframework.boot:spring-boot-starter-actuator"
    compile "org.springframework.boot:spring-boot-starter-web"
    compile "com.fasterxml.jackson.core:jackson-databind"
    compile "commons-lang:commons-lang:${commonsLangVersion}"

    testCompile "org.springframework.boot:spring-boot-starter-test"

}

compileJava.dependsOn verifyGoogleJavaFormat
compileTestJava.dependsOn verifyGoogleJavaFormat

task triggerJob << {

    if (System.getenv('web.apiKey') != null && System.getenv('web.url') != null) {
        print "Running media organizer"
        System.getenv("web.url")
                .toURL()
                .getText(requestProperties: [Authorization: System.getenv('web.apiKey')])
    } else {
        logger.error "Did not find apiKey and/or url in environment variables!"
    }

}